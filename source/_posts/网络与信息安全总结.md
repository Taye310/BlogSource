---
title: 网络与信息安全总结
date: 2018-11-04 16:10:17
tags: 
    - 研究生课程
    - 信息安全
    - 加密
    - 随机数
    - 数字签名
---

# 五种块加密操作模式总结

1. Electronic Code Book(ECB)

ECB模式是最直接的块加密方法，将明文分成若干n-bit的块，然后分别进行块加密。过程如下所示：
加密：  
yi = e(xi) 其中xi等大小为n  
解密：  
xi = e^-1(yi)  
因此ECB模式的速度很快，此外，该模式下各块可以并行操作无需同步，也就是说解密方可以在得到所有块之前就开始进行解密。同时一个字节的错误（丢失）只会影响到其所在块。缺点在于，只要其加密密钥不变，相同明文生成的密文也将一致，最直观的例子就是使用ECB模式加密位图，可以很明显的看出原图的样子，这导致该模式易受到攻击。

2. Cipher Block Chaining(CBC)

CBC模式不同于ECB模式，该模式下所有块被看作是一条完整的消息。CBC模式使用初始向量(Initialization Vector)保证加密的不确定性。第一个块的明文与IV进行与或运算，然后通过块加密算法进行加密。生成的密文作为下一个块的IV，以此类推，这个过程被称为反馈机制。过程如下所示：
加密：  
    y1 = e(xi XOR IV)  
    yi = e(xi XOR yi-1), 以此类推  
解密：  
    x1 = (e^-1(yi) XOR IV)  
    xi = (e^-1(yi) XOR yi-1), 以此类推  
CBC模式最为常用，合理选择IV的情况下可以很大程度抵御攻击，但缺点是其不支持并行。

3. Cipher Feedback(CFB)

CFB模式对IV进行加密，再与明文进行与或运算，生成的密文作为下一块的IV。CFB与OFB模式都将块加密当作流加密处理。加密过程不能并行，解密过程可以。同时如果一个密文损坏，将有两个明文块受损。过程如下所示：
加密：  
y1=e(IV) XOR x1  
yi=(e(yi-1) XOR xi)，以此类推  
解密：  
x1=(e(IV) XOR y1)  
xi=(e(yi-1) XOR yi)，以此类推  

4. Output Feedback(OFB)

与CFB模式类似，区别在于作为下一块IV的数据由与明文与或运算后的密文变为运算之前的密文。如果一个明文或者密文损坏，只有一个相应的密文或者明文损坏，并可以使用校正算法恢复损坏部分的先前值。过程如下：
加密：  
s1= e(IV); y1=(s1 XOR x1)  
si = e(si-1); yi=(si XOR xi)，以此类推  
解密：  
s1= e(IV); x1=(s1 XOR y1)  
si = e(si-1); xi=(si XOR yi)，以此类推  

5. Counter(CTR)

CTR模式使块加密类似于流加密，每块采用一个随机数加计数器作为IV，经过加密运算后与明文进行与或运算后生成密文。优点在于加密解密都可以并行，明文密文一个损坏只影响一个相应输出，并可以使用校正算法恢复。过程如下：
加密：  
yi = (e(IV || CTRi) XOR xi)  
解密：  
xi = (e(IV || CTRi) XOR yi)  

**定性分析与比较：**
ECB模式是最直接的使用块加密算法的方式，该模式速度快但是安全程度低；CBC弥补了ECB模式安全性上的缺陷，安全性高，但是其加密过程不支持并行，会导致效率较低；CFB和OFB模式极为相似，两个模式的加密与解密过程一致并且可以减少代码行数，但是与CBC相同，加密过程不支持并行，使得效率较低，安全性高；最后的CTR模式支持并行，理论上效率最高，安全性高，在实际中也使用最为广泛。

参考资料[pdf](ref.pdf)
加密[文本](text.py)、[图片](pic.py)的脚本